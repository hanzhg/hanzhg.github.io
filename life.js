const canvas=document.querySelector("canvas"),context=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;let currentX=window.innerWidth,currentY=window.innerHeight,mouseX=window.innerWidth,mouseY=window.innerHeight;const res=10,columns=Math.floor(canvas.width/10),rows=Math.floor(canvas.height/10);let on=!1;function buildGrid(){const grid=new Array(columns).fill(0);for(var i=0;i<columns;i++)grid[i]=new Array(rows).fill(0);return grid}let grid=buildGrid();requestAnimationFrame(update);const startButton=document.querySelector("#start"),stopButton=document.querySelector("#stop"),restartButton=document.querySelector("#restart");function update(){on&&(grid=nextGen(grid)),render(grid),currentX+=mouseX-currentX,currentY=currentY+(mouseY-currentY)-155,requestAnimationFrame(update)}function countNeighbors(row,col){let count=0;for(let i=-1;i<2;i++)for(let j=-1;j<2;j++){if(0===i&&0===j)continue;const xCell=col+i,yCell=row+j;xCell>=0&&yCell>=0&&xCell<columns&&yCell<rows&&(count+=grid[col+i][row+j])}return count}function nextGen(grid){const nextGen=grid.map(arr=>[...arr]);for(let col=0;col<grid.length;col++)for(let row=0;row<grid[col].length;row++){const cell=grid[col][row];let numNeighbors=countNeighbors(row,col);1===cell&&numNeighbors<2?nextGen[col][row]=0:1===cell&&numNeighbors>3?nextGen[col][row]=0:0===cell&&3===numNeighbors&&(nextGen[col][row]=1)}return nextGen}function render(grid){for(let col=0;col<grid.length;col++)for(let row=0;row<grid[col].length;row++){const cell=grid[col][row];context.beginPath(),context.rect(10*col,10*row,10,10),defaultTheme?context.fillStyle=cell?"black":"white":context.fillStyle=cell?"white":"black",context.fill()}}startButton.addEventListener("click",(function(){on=!0})),stopButton.addEventListener("click",(function(){on=!1})),restartButton.addEventListener("click",(function(){grid=new Array(columns).fill(0).map(()=>new Array(rows).fill(0)),on=!1})),document.addEventListener("click",(function(){let x=Math.floor(currentX/10),y=Math.floor(currentY/10);grid[x][y]=1}),!1),document.addEventListener("mousemove",(function(event){mouseX=event.pageX,mouseY=event.pageY,null===currentX&&(currentX=event.pageX,currentY=event.pageY)}));